name: Check commit

on:
  workflow_call:

jobs:
  check_commit:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout repository
      uses: actions/checkout@v4
      with:
        token: ${{ secrets.GITHUB_TOKEN }}
    
    - name: check commit
      run: |
        latest_commit_sha=$GITHUB_SHA

        # Отримуємо повну інформацію про останній коміт
        latest_commit_info=$(git log -1 $latest_commit_sha)
        
        # Отримуємо назву останнього коміту
        latest_commit_message=$(echo "$latest_commit_info" | grep -m 1 "commit" | cut -d ' ' -f 2-)
        
        echo "Назва останнього коміту: $latest_commit_message"
    
    - name: Post comment on Pull Request
      if: ${{ always() }}
      uses: thollander/actions-comment-pull-request@v2
      with:
        message: |
          ${{ steps.validate.outputs.validation_result }} There are valid commits according to regulation.